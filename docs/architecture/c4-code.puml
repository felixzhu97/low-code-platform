@startuml C4_Code
!include c4-plantuml/C4_Component.puml

title Code Diagram - 组件管理功能

System_Boundary(component_adapter, "ComponentAdapter") {
    Component(adapter_class, "ComponentAdapter", "TypeScript Class", "适配器类，封装组件相关操作")
}

System_Boundary(create_component_uc, "CreateComponentUseCase") {
    Component(use_case_class, "CreateComponentUseCase", "TypeScript Class", "创建组件用例")
    Component(execute_method, "execute()", "Method", "执行创建组件逻辑")
}

System_Boundary(component_factory, "ComponentFactoryService") {
    Component(factory_class, "ComponentFactoryService", "TypeScript Class", "组件工厂服务")
    Component(create_method, "createComponent()", "Method", "创建组件实例")
}

System_Boundary(component_repo, "IComponentRepository") {
    Component(repo_interface, "IComponentRepository", "TypeScript Interface", "组件仓储接口")
    Component(save_method, "save()", "Method", "保存组件")
    Component(find_method, "findById()", "Method", "根据ID查找组件")
}

System_Boundary(component_repo_impl, "ComponentRepositoryImpl") {
    Component(impl_class, "ComponentRepositoryImpl", "TypeScript Class", "组件仓储实现")
    Component(save_impl, "save()", "Method", "实现保存逻辑")
    Component(find_impl, "findById()", "Method", "实现查找逻辑")
}

System_Boundary(component_store, "ComponentStore") {
    Component(store_class, "useComponentStore", "Zustand Store", "组件状态管理")
    Component(add_action, "addComponent()", "Action", "添加组件到状态")
    Component(update_action, "updateComponent()", "Action", "更新组件状态")
}

System_Boundary(component_entity, "Component Entity") {
    Component(entity_type, "Component", "TypeScript Type", "组件实体类型")
    Component(id_prop, "id: string", "Property", "组件唯一标识")
    Component(type_prop, "type: string", "Property", "组件类型")
    Component(position_prop, "position: Position", "Property", "组件位置")
    Component(properties_prop, "properties: Record", "Property", "组件属性")
}

Rel(adapter_class, use_case_class, "调用", "execute()")
Rel(use_case_class, factory_class, "调用", "createComponent()")
Rel(use_case_class, repo_interface, "调用", "save()")
Rel(repo_interface, impl_class, "实现")
Rel(impl_class, store_class, "使用", "addComponent()")
Rel(adapter_class, store_class, "使用", "updateComponent()")
Rel(factory_class, entity_type, "创建", "Component")

SHOW_LEGEND()

@enduml

